<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Font Awesome for icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="/public/css/admin-css.css">
    <link rel="stylesheet" href="/public/scripts/admin-js.js">
    <link rel="shortcut icon" href="/images/android-chrome-192x192.png" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.16/dist/tailwind.min.css" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.2/xlsx.full.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.7.0/chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/gsap.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.11.4/ScrollTrigger.min.js"></script>
    <style>
        :root {
            --primary-color: #4e73df;
            --secondary-color: #1cc88a;
            --third-color:rgb(88, 161, 88);
            --dark-color: #5a5c69;
            --light-color: #f8f9fc;
        }
        
        body {
            font-family: 'Nunito', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f8f9fc;
        }
        
        .sidebar {
            background: linear-gradient(180deg, var(--primary-color) 10%, #224abe 100%);
            min-height: 100vh;
            position: fixed;
            top: 0;
            left: 0;
            width: 230px;
            z-index: 999;
            transition: all 0.3s;
        }
        
        .sidebar-brand {
            height: 4.375rem;
            text-decoration: none;
            font-size: 1rem;
            font-weight: 800;
            padding: 1.5rem 1rem;
            text-align: center;
            letter-spacing: 0.05rem;
            z-index: 1;
        }
        
        .sidebar-brand span {
            font-size: 1.75rem;
        }
        
        .sidebar-divider {
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            margin: 0 1rem 1rem;
        }
        
        .nav-item {
            position: relative;
            margin-bottom: 0.25rem;
        }
        
        .nav-link {
            display: block;
            padding: 0.75rem 1rem;
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: all 0.3s;
        }
        
        .nav-link:hover, .nav-link.active {
            color: #fff;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 0.35rem;
        }
        
        .nav-link i {
            margin-right: 0.5rem;
            opacity: 0.75;
        }
        
        #wrapper {
            display: flex;
        }
        
        #content-wrapper {
            background-color: #f8f9fc;
            width: 100%;
            overflow-x: hidden;
            margin-left: 230px;
            transition: all 0.3s;
        }
        
        .navbar {
            background-color: #fff;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.15);
            position: relative;
            z-index: 1;
        }
        
        .card {
            border: none;
            border-radius: 0.35rem;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.1);
            margin-bottom: 1.5rem;
        }
        
        .card-header {
            background-color: #f8f9fc;
            border-bottom: 1px solid #e3e6f0;
            padding: 0.75rem 1.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-header h6 {
            font-weight: 700;
            margin-bottom: 0;
            color: var(--primary-color);
        }
        
        .dashboard-card {
            background-color: #fff;
            border-left: 0.25rem solid var(--primary-color);
            border-radius: 0.35rem;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.1);
            margin-bottom: 1.5rem;
            padding: 1rem;
            position: relative;
            transition: transform 0.3s;
        }
        
        .dashboard-card:hover {
            transform: translateY(-5px);
        }
        
        .dashboard-card-blue {
            border-left-color: var(--primary-color);
        }
        
        .dashboard-card-green {
            border-left-color: var(--secondary-color);
        }
        
        .dashboard-card-yellow {
            border-left-color: #f6c23e;
        }
        
        .dashboard-card-red {
            border-left-color: #e74a3b;
        }
        
        .dashboard-card h4 {
            color: var(--dark-color);
            font-weight: 700;
            margin-bottom: 0.5rem;
        }
        
        .dashboard-card .number {
            color: var(--dark-color);
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .dashboard-card .icon {
            position: absolute;
            top: 50%;
            right: 1.5rem;
            transform: translateY(-50%);
            color: rgba(0, 0, 0, 0.1);
            font-size: 2rem;
        }
        
        .custom-dropdown .dropdown-toggle::after {
            display: none;
        }
        
        .toggle-sidebar {
            display: none;
        }
        
        @media (max-width: 768px) {
            .sidebar {
                margin-left: -230px;
            }
            
            #content-wrapper {
                margin-left: 0;
            }
            
            .sidebar.toggled {
                margin-left: 0;
            }
            
            #content-wrapper.toggled {
                margin-left: 230px;
            }
            
            .toggle-sidebar {
                display: block;
            }
        }
        
        .table-responsive {
            max-height: 400px;
            overflow-y: auto;
        }
        
        .filter-section {
            background-color: #fff;
            border-radius: 0.35rem;
            padding: 1rem;
            margin-bottom: 1rem;
            box-shadow: 0 0.15rem 1.75rem 0 rgba(58, 59, 69, 0.1);
        }
        
        .form-card {
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .form-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 0.5rem 2rem 0 rgba(58, 59, 69, 0.15);
        }
        
        .badge-active {
            background-color: var(--secondary-color);
        }
        
        .badge-inactive {
            background-color: #e74a3b;
        }
        
        .badge-pending {
            background-color: #f6c23e;
        }
    </style>
</head>
<body>

<div id="wrapper">
    <!-- Sidebar -->
    <%- include('./partials/adminSideNavbar', { path: currentPath }) %>
    <!-- Content Wrapper -->
    <div id="content-wrapper" class="d-flex flex-column">
        <!-- Main Content -->
        <div id="content">
            <!-- Topbar -->
              <%- include('partials/adminTopNavbar', { admin: adminData }) %>
            <!-- Begin Page Content -->
            <div class="container-fluid px-5">
                <!-- Page Heading -->
                <div class="d-sm-flex align-items-center justify-content-between mb-4">
                    <h1 class="h3 mb-0 text-gray-800">Dashboard</h1>
                    <a href="#" class="d-none d-sm-inline-block btn btn-sm btn-primary shadow-sm">
                        <i class="fas fa-download fa-sm text-white-50"></i> Generate Report
                    </a>
                </div>
                
                <!-- Content Row -->
                <div class="row">
                    <!-- Faculty Card -->
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="dashboard-card dashboard-card-blue">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <h4 class="font-weight-bold text-primary text-uppercase mb-1">
                                            Faculty Members
                                        </h4>
                                        <div class="number mb-0">4444</div>
                                        <div class="dropdown mt-2">
                                            <button class="btn btn-sm btn-outline-primary dropdown-toggle" type="button" id="facultyDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                                Filter by Subject
                                            </button>
                                            <ul class="dropdown-menu" aria-labelledby="facultyDropdown">
                                                <li><a class="dropdown-item" href="#">All Subjects</a></li>
                                                <li><a class="dropdown-item" href="#">Computer Science</a></li>
                                                <li><a class="dropdown-item" href="#">Mathematics</a></li>
                                                <li><a class="dropdown-item" href="#">Physics</a></li>
                                                <li><a class="dropdown-item" href="#">Chemistry</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-chalkboard-teacher fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Students Card -->
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="dashboard-card dashboard-card-green">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <h4 class="font-weight-bold text-success text-uppercase mb-1">
                                            Students
                                        </h4>
                                        <div class="number mb-0">44444</div>
                                        <div class="dropdown mt-2">
                                            <button class="btn btn-sm btn-outline-success dropdown-toggle" type="button" id="sectionDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                                                Filter by Section
                                            </button>
                                            <ul class="dropdown-menu" aria-labelledby="sectionDropdown">
                                                <li><a class="dropdown-item" href="#">All Sections</a></li>
                                                <li><a class="dropdown-item" href="#">Section A</a></li>
                                                <li><a class="dropdown-item" href="#">Section B</a></li>
                                                <li><a class="dropdown-item" href="#">Section C</a></li>
                                                <li><a class="dropdown-item" href="#">Section D</a></li>
                                            </ul>
                                        </div>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-user-graduate fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Feedback Submitted Card -->
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="dashboard-card dashboard-card-yellow">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <h4 class="font-weight-bold text-warning text-uppercase mb-1">
                                            Submitted Feedback
                                        </h4>
                                        <div class="number mb-0">200</div>
                                        <a href="#" class="btn btn-sm btn-outline-warning mt-2">View Details</a>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-clipboard-check fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Pending Feedback Card -->
                    <div class="col-xl-3 col-md-6 mb-4">
                        <div class="dashboard-card dashboard-card-red">
                            <div class="card-body">
                                <div class="row align-items-center">
                                    <div class="col">
                                        <h4 class="font-weight-bold text-danger text-uppercase mb-1">
                                            Pending Feedback
                                        </h4>
                                        <div class="number mb-0">22</div>
                                        <a href="#" class="btn btn-sm btn-outline-danger mt-2">View Details</a>
                                    </div>
                                    <div class="col-auto">
                                        <i class="fas fa-clipboard-list fa-2x text-gray-300"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Content Row -->
                <div class="row">
                    <!-- Create Feedback Forms Section -->
                    <div class="col-lg-6 mb-4">
                        <div class="card shadow mb-4">
                            <div class="card-header py-4">
                                <h6 class="m-0 font-weight-bold text-primary">Create Feedback Forms</h6>
                            </div>
                            <div class="card-body py-16">
                                <!-- <p>Create new feedback forms using templates or manual entry.</p> -->
                                <div class="row">
                                    <div class="col-md-4 mb-3">
                                        <div class="card form-card">
                                            <div class="card-body text-center">
                                                <i class="fas fa-book fa-3x mb-3 text-primary"></i>
                                                <h5>Academic</h5>
                                                <a href="#" class="btn btn-sm btn-primary mt-2">Create</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="card form-card">
                                            <div class="card-body text-center">
                                                <i class="fas fa-university fa-3x mb-3 text-success"></i>
                                                <h5>Institutional</h5>
                                                <a href="#" class="btn btn-sm btn-success mt-2">Create</a>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="col-md-4 mb-3">
                                        <div class="card form-card">
                                            <div class="card-body text-center">
                                                <i class="fas fa-laptop-code fa-3x mb-3 text-info"></i>
                                                <h5>Training</h5>
                                                <a href="#" class="btn btn-sm btn-info mt-2">Create</a>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="text-center mt-3">
                                    <a href="#" class="btn btn-primary">
                                        <i class="fas fa-plus mr-2"></i>Create Custom Form
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Manage Forms Section -->
                    <div class="col-lg-6 mb-4">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">Manage Feedback Forms</h6>
                                <div class="input-group" style="width: 200px;">
                                    <select class="form-select form-select-sm" id="formStatusFilter">
                                        <option value="all">All Forms</option>
                                        <option value="active">Active</option>
                                        <option value="inactive">Inactive</option>
                                        <option value="pending">Pending</option>
                                    </select>
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Form Title</th>
                                                <th>Type</th>
                                                <th>Status</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>End Semester Feedback</td>
                                                <td>Academic</td>
                                                <td><span class="badge bg-success">Active</span></td>
                                                <td>
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                                        <button class="btn btn-sm btn-danger"><i class="fas fa-power-off"></i></button>
                                                        <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Faculty Evaluation</td>
                                                <td>Academic</td>
                                                <td><span class="badge bg-success">Active</span></td>
                                                <td>
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                                        <button class="btn btn-sm btn-danger"><i class="fas fa-power-off"></i></button>
                                                        <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Infrastructure Feedback</td>
                                                <td>Institutional</td>
                                                <td><span class="badge bg-danger">Inactive</span></td>
                                                <td>
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                                        <button class="btn btn-sm btn-success"><i class="fas fa-power-off"></i></button>
                                                        <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Workshop Feedback</td>
                                                <td>Training</td>
                                                <td><span class="badge bg-warning text-dark">Pending</span></td>
                                                <td>
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                                        <button class="btn btn-sm btn-success"><i class="fas fa-power-off"></i></button>
                                                        <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                                    </div>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>Lab Equipment Feedback</td>
                                                <td>Institutional</td>
                                                <td><span class="badge bg-success">Active</span></td>
                                                <td>
                                                    <div class="btn-group">
                                                        <button class="btn btn-sm btn-primary"><i class="fas fa-edit"></i></button>
                                                        <button class="btn btn-sm btn-danger"><i class="fas fa-power-off"></i></button>
                                                        <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i></button>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="d-flex justify-content-between mt-3">
                                    <a href="#" class="btn btn-outline-primary">Assign Forms</a>
                                    <a href="#" class="btn btn-outline-secondary">View All Forms</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- Content Row -->
                <div class="row">
                    <!-- Student Feedback Status Section -->
                    <div class="col-lg-12 mb-4">
                        <div class="card shadow mb-4">
                            <div class="card-header py-3 d-flex justify-content-between align-items-center">
                                <h6 class="m-0 font-weight-bold text-primary">Student Feedback Status</h6>
                                <div class="input-group" style="width: 200px;">
                                    <input type="text" class="form-control form-control-sm" placeholder="Search student...">
                                </div>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Student ID</th>
                                                <th>Student Name</th>
                                                <th>Section</th>
                                                <th>Academic Feedback</th>
                                                <th>Institutional Feedback</th>
                                                <th>Training Feedback</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody>
                                            <tr>
                                                <td>S12345</td>
                                                <td>John Doe</td>
                                                <td>A</td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i> View</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>S12346</td>
                                                <td>Jane Smith</td>
                                                <td>B</td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td><span class="badge bg-danger">Pending</span></td>
                                                <td><span class="badge bg-danger">Pending</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i> View</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>S12347</td>
                                                <td>Mike Johnson</td>
                                                <td>A</td>
                                                <td><span class="badge bg-danger">Pending</span></td>
                                                <td><span class="badge bg-danger">Pending</span></td>
                                                <td><span class="badge bg-danger">Pending</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-warning"><i class="fas fa-bell"></i> Remind</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>S12348</td>
                                                <td>Sarah Williams</td>
                                                <td>C</td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td><span class="badge bg-danger">Pending</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i> View</button>
                                                </td>
                                            </tr>
                                            <tr>
                                                <td>S12349</td>
                                                <td>Robert Brown</td>
                                                <td>B</td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td><span class="badge bg-success">Submitted</span></td>
                                                <td>
                                                    <button class="btn btn-sm btn-info"><i class="fas fa-eye"></i> View</button>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <div class="d-flex justify-content-between mt-3">
                                    <div>
                                        <button class="btn btn-outline-warning">Send Reminders</button>
                                        <button class="btn btn-outline-primary ml-2">Export List</button>
                                    </div>
                                    <nav aria-label="Page navigation">
                                        <ul class="pagination pagination-sm">
                                            <li class="page-item disabled"><a class="page-link" href="#">Previous</a></li>
                                            <li class="page-item active"><a class="page-link" href="#">1</a></li>
                                            <li class="page-item"><a class="page-link" href="#">2</a></li>
                                            <li class="page-item"><a class="page-link" href="#">3</a></li>
                                            <li class="page-item"><a class="page-link" href="#">4</a></li>
                                            <li class="page-item"><a class="page-link" href="#">Next</a></li>
                                        </ul>
                                    </nav>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.container-fluid -->
        </div>
        <!-- Data Visualization -->
        <main class="flex-1 p-10 overflow-y-auto">

            <div class="mb-8">
                <h1 class="text-4xl font-bold text-gray-800 text-center mt-6">DATA VISUALIZATION</h1>
              
            </div>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                <!-- Course Organization and Delivery -->
                <div class="bg-white p-5 rounded shadow">
                    <h3 class="text-lg font-semibold mb-4">Course Organization and Delivery</h3>
                    <canvas id="genderPreferencesChart"></canvas>
                </div>
        
                <!-- Teacher Effectiveness -->
                <div class="bg-white p-5 rounded shadow">
                    <h3 class="text-lg font-semibold mb-4">Teacher Effectiveness</h3>
                    <canvas id="teacherEffectivenessChart"></canvas>
                </div>
        
                <!-- Student Learning Experience -->
                <div class="bg-white p-5 rounded shadow">
                    <h3 class="text-lg font-semibold mb-4">Student Learning Experience</h3>
                    <canvas id="studentExperienceChart"></canvas>
                </div>
        
                <!-- Exams and Evaluation -->
                <div class="bg-white p-5 rounded shadow">
                    <h3 class="text-lg font-semibold mb-4">Exams and Evaluation</h3>
                    <canvas id="examsEvaluationChart"></canvas>
                </div>
        
                <!-- General Course Questions -->
                <div class="bg-white p-5 rounded shadow">
                    <h3 class="text-lg font-semibold mb-4">General Course Questions</h3>
                    <canvas id="generalQuestionsChart"></canvas>
                </div>
        
                <!-- Tutorial & Lab Components -->
                <div class="bg-white p-5 rounded shadow">
                    <h3 class="text-lg font-semibold mb-4">Tutorial & Lab Components</h3>
                    <canvas id="tutorialLabChart"></canvas>
                </div>
            </div>
            <button id="downloadExcel"
                class="mt-10 bg-green-300 hover:bg-green-200 text-green-800 font-semibold py-3 px-6 rounded-lg shadow-md transition duration-300 ease-in-out transform hover:-translate-y-1 hover:shadow-lg flex items-center justify-center space-x-2">
                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none"
                    stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"
                    class="lucide lucide-download">
                    <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"></path>
                    <polyline points="7 10 12 15 17 10"></polyline>
                    <line x1="12" x2="12" y1="15" y2="3"></line>
                </svg>
                <span>Download Excel</span>
            </button>
        </main>
        <!-- Footer -->
        <%- include('partials/adminBottomNavbar') %>
        <!-- End of Footer -->
    </div>
    <!-- End of Content Wrapper -->
</div>

<!-- End of Page Wrapper -->

<!-- Bootstrap core JavaScript -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
<!-- Custom scripts -->
<script>
    document.addEventListener('DOMContentLoaded', function() {
        // Toggle sidebar
        const toggleSidebar = document.querySelector('.toggle-sidebar');
        const sidebar = document.querySelector('.sidebar');
        const contentWrapper = document.querySelector('#content-wrapper');
        
        if (toggleSidebar) {
            toggleSidebar.addEventListener('click', function() {
                sidebar.classList.toggle('toggled');
                contentWrapper.classList.toggle('toggled');
            });
        }
        
        // Dropdown functionality
        const dropdowns = document.querySelectorAll('.dropdown-toggle');
        dropdowns.forEach(dropdown => {
            new bootstrap.Dropdown(dropdown);
        });
    });



     // Gender Preferences Chart
                // Gender Preferences Chart
                new Chart(document.getElementById('genderPreferencesChart'), {
                    type: 'bar',
                    data: {
                        labels: ['Math', 'Science', 'Literature', 'Art'],
                        datasets: [{
                            label: 'Person',
                            data: [75, 80, 60, 55],
                            backgroundColor: 'rgba(54, 162, 235, 0.8)',
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Preference Score'
                                }
                            }
                        }
                    }
                });

                // Teacher Effectiveness Chart
                new Chart(document.getElementById('teacherEffectivenessChart'), {
                    type: 'bar',
                    data: {
                        labels: ['Communication', 'Knowledge', 'Engagement', 'Feedback'],
                        datasets: [{
                            label: 'Effectiveness',
                            data: [85, 92, 78, 88],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.8)',
                                'rgba(54, 162, 235, 0.8)',
                                'rgba(255, 206, 86, 0.8)',
                                'rgba(75, 192, 192, 0.8)'
                            ],
                        }]
                    },
                    options: {
                        responsive: true,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: 'Effectiveness Score'
                                }
                            }
                        }
                    }
                });

                // Student Learning Experience Chart
                new Chart(document.getElementById('studentExperienceChart'), {
                    type: 'pie',
                    data: {
                        labels: ['Very Satisfied', 'Satisfied', 'Neutral', 'Dissatisfied'],
                        datasets: [{
                            data: [45, 35, 15, 5],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.8)',
                                'rgba(54, 162, 235, 0.8)',
                                'rgba(255, 206, 86, 0.8)',
                                'rgba(75, 192, 192, 0.8)'
                            ],
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Overall Learning Experience'
                            }
                        }
                    }
                });

                // Exams and Evaluation Chart
                new Chart(document.getElementById('examsEvaluationChart'), {
                    type: 'doughnut',
                    data: {
                        labels: ['Fair', 'Challenging', 'Well-structured', 'Needs Improvement'],
                        datasets: [{
                            data: [50, 30, 15, 5],
                            backgroundColor: [
                                'rgba(255, 99, 132, 0.8)',
                                'rgba(54, 162, 235, 0.8)',
                                'rgba(255, 206, 86, 0.8)',
                                'rgba(75, 192, 192, 0.8)'
                            ],
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            title: {
                                display: true,
                                text: 'Exam and Evaluation Quality'
                            }
                        }
                    }
                });

                // General Course Questions Chart
                new Chart(document.getElementById('generalQuestionsChart'), {
                    type: 'bar',
                    data: {
                        labels: ['Course Relevance', 'Material Quality', 'Workload', 'Support Available', 'Overall Satisfaction'],
                        datasets: [{
                            label: 'Average Score',
                            data: [4.2, 4.0, 3.8, 4.1, 4.3],
                            backgroundColor: 'rgba(54, 162, 235, 0.8)',
                        }]
                    },
                    options: {
                        responsive: true,
                        indexAxis: 'y',
                        scales: {
                            x: {
                                beginAtZero: true,
                                max: 5,
                                title: {
                                    display: true,
                                    text: 'Score (out of 5)'
                                }
                            }
                        }
                    }
                });

                // Tutorial & Lab Components Chart
                new Chart(document.getElementById('tutorialLabChart'), {
                    type: 'radar',
                    data: {
                        labels: ['Clarity', 'Relevance', 'Equipment', 'Assistance', 'Time Allocation'],
                        datasets: [{
                            label: 'Tutorials',
                            data: [4.5, 4.2, 4.0, 4.3, 3.8],
                            fill: true,
                            backgroundColor: 'rgba(255, 99, 132, 0.2)',
                            borderColor: 'rgb(255, 99, 132)',
                            pointBackgroundColor: 'rgb(255, 99, 132)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(255, 99, 132)'
                        }, {
                            label: 'Labs',
                            data: [4.2, 4.5, 4.1, 4.4, 4.0],
                            fill: true,
                            backgroundColor: 'rgba(54, 162, 235, 0.2)',
                            borderColor: 'rgb(54, 162, 235)',
                            pointBackgroundColor: 'rgb(54, 162, 235)',
                            pointBorderColor: '#fff',
                            pointHoverBackgroundColor: '#fff',
                            pointHoverBorderColor: 'rgb(54, 162, 235)'
                        }]
                    },
                    options: {
                        responsive: true,
                        elements: {
                            line: {
                                borderWidth: 3
                            }
                        },
                        scales: {
                            r: {
                                angleLines: {
                                    display: false
                                },
                                suggestedMin: 0,
                                suggestedMax: 5
                            }
                        }
                    }
                });

                document.getElementById('downloadExcel').addEventListener('click', function () {
                    // Define data for each chart
                    const courseFeedbackData = [
                        ['Aspect', 'Rating (out of 5)'],
                        ['Course Content', 4.5],
                        ['Teaching Methods', 4.2],
                        ['Learning Resources', 4.0],
                        ['Assignments', 3.8],
                        ['Overall Satisfaction', 4.3]
                    ];

                    const teacherEffectivenessData = [
                        ['Category', 'Effectiveness (out of 5)'],
                        ['Communication', 4.5],
                        ['Knowledge', 4.8],
                        ['Engagement', 4.2],
                        ['Feedback', 4.6]
                    ];

                    const studentExperienceData = [
                        ['Experience', 'Rating'],
                        ['Very Satisfied', 4],
                        ['Satisfied', 3],
                        ['Neutral', 2],
                        ['Dissatisfied', 1]
                    ];

                    const examsEvaluationData = [
                        ['Aspect', 'Rating (out of 5)'],
                        ['Fairness', 4.2],
                        ['Difficulty Level', 3.8],
                        ['Clarity of Questions', 4.0],
                        ['Time Allocation', 3.9]
                    ];

                    const generalQuestionsData = [
                        ['Question', 'Response (out of 5)'],
                        ['Course Relevance to Career', 4.5],
                        ['Material Quality', 4.2],
                        ['Workload Manageability', 3.8],
                        ['Support Availability', 4.1],
                        ['Would Recommend Course', 4.3]
                    ];

                    const tutorialLabData = [
                        ['Component', 'Tutorials Rating', 'Labs Rating'],
                        ['Clarity of Instructions', 4.5, 4.2],
                        ['Relevance to Course', 4.2, 4.5],
                        ['Equipment/Resources', 4.0, 4.1],
                        ['Staff Assistance', 4.3, 4.4],
                        ['Time Allocation', 3.8, 4.0]
                    ];

                    // Function to apply styling to a sheet
                    function styleSheet(sheet) {
                        const range = XLSX.utils.decode_range(sheet['!ref']);
                        const columnWidths = [];

                        // Style for headers
                        const headerStyle = {
                            font: { bold: true, color: { rgb: "FFFFFF" } },
                            fill: { fgColor: { rgb: "4472C4" } },
                            alignment: { horizontal: "center", vertical: "center" }
                        };

                        // Style for data cells
                        const dataStyle = {
                            alignment: { horizontal: "center", vertical: "center" },
                            border: {
                                top: { style: "thin" },
                                bottom: { style: "thin" },
                                left: { style: "thin" },
                                right: { style: "thin" }
                            }
                        };

                        for (let C = range.s.c; C <= range.e.c; ++C) {
                            let maxColWidth = 10; // Minimum width
                            for (let R = range.s.r; R <= range.e.r; ++R) {
                                const cell = sheet[XLSX.utils.encode_cell({ c: C, r: R })];
                                if (!cell) continue;
                                const cellValue = cell.v.toString();
                                maxColWidth = Math.max(maxColWidth, cellValue.length);

                                // Apply styles
                                if (R === 0) {
                                    cell.s = headerStyle;
                                } else {
                                    cell.s = dataStyle;
                                }
                            }
                            columnWidths[C] = maxColWidth;
                        }

                        sheet['!cols'] = columnWidths.map(w => ({ wch: w }));
                    }

                    // Create a new workbook and add data
                    const workbook = XLSX.utils.book_new();
                    const sheets = [
                        { name: 'Course Feedback', data: courseFeedbackData },
                        { name: 'Teacher Effectiveness', data: teacherEffectivenessData },
                        { name: 'Student Experience', data: studentExperienceData },
                        { name: 'Exams Evaluation', data: examsEvaluationData },
                        { name: 'General Questions', data: generalQuestionsData },
                        { name: 'Tutorial & Lab', data: tutorialLabData }
                    ];

                    sheets.forEach(sheet => {
                        const ws = XLSX.utils.aoa_to_sheet(sheet.data);
                        styleSheet(ws);
                        XLSX.utils.book_append_sheet(workbook, ws, sheet.name);
                    });

                    // Export workbook
                    XLSX.writeFile(workbook, 'individual_feedback_data.xlsx');
                });

</script>
</body>
</html>